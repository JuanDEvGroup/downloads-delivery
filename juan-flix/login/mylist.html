<html><head><base href="https://websimdemo.com/netflix-style-list/">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mi Lista de Películas y Series</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #141414;
    color: #fff;
    margin: 0;
    padding: 0;
  }
  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
  }
  h1 {
    text-align: center;
    color: #e50914;
  }
  .list {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-around;
  }
  .item {
    width: 200px;
    margin: 10px;
    transition: transform 0.3s ease-in-out;
    position: relative;
  }
  .item:hover {
    transform: scale(1.05);
  }
  .item img {
    width: 100%;
    height: 300px;
    object-fit: cover;
    border-radius: 4px;
  }
  .item .title {
    margin-top: 5px;
    font-weight: bold;
    text-align: center;
  }
  .item .remove {
    position: absolute;
    top: 5px;
    right: 5px;
    background-color: rgba(0, 0, 0, 0.7);
    color: white;
    border: none;
    border-radius: 50%;
    width: 25px;
    height: 25px;
    font-size: 16px;
    cursor: pointer;
    display: none;
  }
  .item:hover .remove {
    display: block;
  }
  #addMovieForm {
    margin-top: 20px;
    text-align: center;
  }
  #addMovieForm select, #addMovieForm button {
    margin: 5px;
    padding: 5px 10px;
    font-size: 16px;
  }
  .error {
    color: #e50914;
    text-align: center;
    margin-top: 10px;
  }
</style>
</head>
<body>
  <div class="container">
    <h1>Mi Lista</h1>
    <div class="list" id="myList">
      <!-- Los elementos de la lista se agregarán aquí dinámicamente -->
    </div>
    <form id="addMovieForm">
      <select id="movieSelect">
        <option value="">Selecciona una película o serie</option>
        <!-- Las opciones se agregarán dinámicamente -->
      </select>
      <button type="submit">Agregar a Mi Lista</button>
    </form>
    <div id="error" class="error"></div>
  </div>

  <script>
    const myList = document.getElementById('myList');
    const addMovieForm = document.getElementById('addMovieForm');
    const movieSelect = document.getElementById('movieSelect');
    const errorElement = document.getElementById('error');
    let movies = [];
    let availableMovies = [
      { title: 'Stranger Things', image: 'https://websimdemo.com/netflix-style-list/images/stranger-things.jpg' },
      { title: 'The Crown', image: 'https://websimdemo.com/netflix-style-list/images/the-crown.jpg' },
      { title: 'Narcos', image: 'https://websimdemo.com/netflix-style-list/images/narcos.jpg' },
      { title: 'Black Mirror', image: 'https://websimdemo.com/netflix-style-list/images/black-mirror.jpg' },
      { title: 'Breaking Bad', image: 'https://websimdemo.com/netflix-style-list/images/breaking-bad.jpg' },
      { title: 'The Witcher', image: 'https://websimdemo.com/netflix-style-list/images/the-witcher.jpg' },
      { title: 'Money Heist', image: 'https://websimdemo.com/netflix-style-list/images/money-heist.jpg' },
      { title: 'Dark', image: 'https://websimdemo.com/netflix-style-list/images/dark.jpg' }
    ];

    function setCookie(name, value, days) {
      let expires = "";
      if (days) {
        const date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        expires = "; expires=" + date.toUTCString();
      }
      document.cookie = name + "=" + (value || "")  + expires + "; path=/";
    }

    function getCookie(name) {
      const nameEQ = name + "=";
      const ca = document.cookie.split(';');
      for(let i = 0; i < ca.length; i++) {
        let c = ca[i];
        while (c.charAt(0) == ' ') c = c.substring(1, c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
      }
      return null;
    }

    function loadMovies() {
      try {
        const storedMovies = getCookie('movies');
        if (storedMovies) {
          movies = JSON.parse(storedMovies);
        }
      } catch (error) {
        console.error('Error loading movies from cookies:', error);
        errorElement.textContent = 'Error al cargar las películas. Se usará una lista vacía.';
        movies = [];
      }
    }

    function displayMovies() {
      myList.innerHTML = '';
      movies.forEach((movie, index) => {
        const itemElement = document.createElement('div');
        itemElement.className = 'item';
        itemElement.innerHTML = `
          <img src="${movie.image}" alt="${movie.title}" width="200" height="300" onerror="this.src='https://via.placeholder.com/200x300?text=Image+Not+Found'">
          <div class="title">${movie.title}</div>
          <button class="remove" onclick="removeMovie(${index})">×</button>
        `;
        myList.appendChild(itemElement);
      });
    }

    function addMovie(title, image) {
      if (!movies.some(movie => movie.title === title)) {
        movies.push({ title, image });
        saveMovies();
        displayMovies();
        updateAvailableMovies();
      } else {
        errorElement.textContent = 'Esta película ya está en tu lista.';
      }
    }

    function removeMovie(index) {
      movies.splice(index, 1);
      saveMovies();
      displayMovies();
      updateAvailableMovies();
    }

    function saveMovies() {
      try {
        setCookie('movies', JSON.stringify(movies), 30); // Guarda por 30 días
      } catch (error) {
        console.error('Error saving movies to cookies:', error);
        errorElement.textContent = 'Error al guardar las películas. Los cambios no se mantendrán después de cerrar el navegador.';
      }
    }

    function updateAvailableMovies() {
      movieSelect.innerHTML = '<option value="">Selecciona una película o serie</option>';
      availableMovies.forEach(movie => {
        if (!movies.some(m => m.title === movie.title)) {
          const option = document.createElement('option');
          option.value = movie.title;
          option.textContent = movie.title;
          movieSelect.appendChild(option);
        }
      });
    }

    addMovieForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const selectedTitle = movieSelect.value;
      if (selectedTitle) {
        const selectedMovie = availableMovies.find(movie => movie.title === selectedTitle);
        addMovie(selectedMovie.title, selectedMovie.image);
        movieSelect.value = '';
        errorElement.textContent = '';
      } else {
        errorElement.textContent = 'Por favor, selecciona una película o serie.';
      }
    });

    // Cargar las películas al iniciar
    loadMovies();
    displayMovies();
    updateAvailableMovies();
  </script>
</body>
</html>